SELECT BM1_ANO, BM1_MES, SUM(BM1_VALOR) FROM BM1020 BM1 INNER JOIN BQC020 BQC ON (BQC_NUMCON = BM1_CONEMP AND BQC_SUBCON = BM1_SUBCON  AND BQC.D_E_L_E_T_='')
WHERE BM1.D_E_L_E_T_ = ''
AND BQC_CIE309 = 'S'
AND (BM1_ANO = '2022' OR BM1_ANO = '2023' AND BM1_MES = '01')
AND BM1_CODEMP = '0002'
AND BM1_CODTIP = '101'
GROUP BY BM1_ANO, BM1_MES
ORDER BY BM1_ANO, BM1_MES


SELECT BD5_ANOPAG, BD5_MESPAG, SUM(BD5_VLRPAG) FROM BD5020 BD5 INNER JOIN BQC020 BQC ON (BQC_NUMCON = BD5_CONEMP AND BQC_SUBCON = BD5_SUBCON  AND BQC.D_E_L_E_T_='')
WHERE BD5.D_E_L_E_T_ = ''
AND BQC_CIE309 = 'S'
AND (BD5_ANOPAG = '2022' OR BD5_ANOPAG = '2023' AND BD5_MESPAG = '01')
AND BD5_CODEMP = '0002'
AND BD5_SITUAC= '1'
AND BD5_FASE = '4'
AND BD5_VLRPAG > 0
GROUP BY BD5_ANOPAG, BD5_MESPAG
ORDER BY BD5_ANOPAG, BD5_MESPAG


SELECT CASE 
WHEN Datediff(yyyy,Convert(Datetime,BA1_DATNAS,03),GETDATE()) BETWEEN 0  AND 18 THEN '00 a 18'	
WHEN Datediff(yyyy,Convert(Datetime,BA1_DATNAS,03),GETDATE()) BETWEEN 19 AND 23 THEN '19 a 23'	
WHEN Datediff(yyyy,Convert(Datetime,BA1_DATNAS,03),GETDATE()) BETWEEN 24 AND 28 THEN '24 a 28'		
WHEN Datediff(yyyy,Convert(Datetime,BA1_DATNAS,03),GETDATE()) BETWEEN 29 AND 33 THEN '29 a 33'		
WHEN Datediff(yyyy,Convert(Datetime,BA1_DATNAS,03),GETDATE()) BETWEEN 34 AND 38 THEN '34 a 38'		
WHEN Datediff(yyyy,Convert(Datetime,BA1_DATNAS,03),GETDATE()) BETWEEN 39 AND 43 THEN '39 a 43'		
WHEN Datediff(yyyy,Convert(Datetime,BA1_DATNAS,03),GETDATE()) BETWEEN 44 AND 48 THEN '44 a 48'		
WHEN Datediff(yyyy,Convert(Datetime,BA1_DATNAS,03),GETDATE()) BETWEEN 49 AND 53 THEN '49 a 53'		
WHEN Datediff(yyyy,Convert(Datetime,BA1_DATNAS,03),GETDATE()) BETWEEN 54 AND 58 THEN '54 a 58'
WHEN Datediff(yyyy,Convert(Datetime,BA1_DATNAS,03),GETDATE()) >= 59 THEN  '59 + ' END  FAIXA 																		 	
, count (*) 
FROM BA1020 BA1 INNER JOIN BQC020 BQC ON (BQC_NUMCON = BA1_CONEMP AND BQC_SUBCON = BA1_SUBCON  AND BQC.D_E_L_E_T_='')
WHERE BA1.D_E_L_E_T_ = ''
AND BQC_CIE309 = 'S'
AND BA1_CODEMP = '0002'
AND BA1_TIPUSU = 'D'
AND BA1_SEXO = '1'
AND BA1_MOTBLO = ''
AND BA1_DATINC <= '20231231'
group by 
CASE 
WHEN Datediff(yyyy,Convert(Datetime,BA1_DATNAS,03),GETDATE()) BETWEEN 0  AND 18 THEN '00 a 18'	
WHEN Datediff(yyyy,Convert(Datetime,BA1_DATNAS,03),GETDATE()) BETWEEN 19 AND 23 THEN '19 a 23'	
WHEN Datediff(yyyy,Convert(Datetime,BA1_DATNAS,03),GETDATE()) BETWEEN 24 AND 28 THEN '24 a 28'		
WHEN Datediff(yyyy,Convert(Datetime,BA1_DATNAS,03),GETDATE()) BETWEEN 29 AND 33 THEN '29 a 33'		
WHEN Datediff(yyyy,Convert(Datetime,BA1_DATNAS,03),GETDATE()) BETWEEN 34 AND 38 THEN '34 a 38'		
WHEN Datediff(yyyy,Convert(Datetime,BA1_DATNAS,03),GETDATE()) BETWEEN 39 AND 43 THEN '39 a 43'		
WHEN Datediff(yyyy,Convert(Datetime,BA1_DATNAS,03),GETDATE()) BETWEEN 44 AND 48 THEN '44 a 48'		
WHEN Datediff(yyyy,Convert(Datetime,BA1_DATNAS,03),GETDATE()) BETWEEN 49 AND 53 THEN '49 a 53'		
WHEN Datediff(yyyy,Convert(Datetime,BA1_DATNAS,03),GETDATE()) BETWEEN 54 AND 58 THEN '54 a 58'
WHEN Datediff(yyyy,Convert(Datetime,BA1_DATNAS,03),GETDATE()) >= 59 THEN  '59 + ' END








